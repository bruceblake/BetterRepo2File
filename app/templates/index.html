<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Convert a repository or files to a single text file optimized for LLM prompts">
    <meta name="keywords" content="repo2file, repository converter, LLM, AI, code consolidation">
    <title>Repo2File - Vibe Coder Assistant</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header role="banner">
            <h1>Repo2File <span class="badge">Vibe Coder Edition</span></h1>
            <p>Your AI-powered workflow assistant for Gemini planning ‚Üí Claude coding</p>
        </header>

        <main role="main">
            <!-- Workflow Mode Selection -->
            <section class="workflow-mode">
                <h2>Select Your Workflow</h2>
                <div class="mode-cards">
                    <div class="mode-card active" id="vibe-mode">
                        <span class="icon">üöÄ</span>
                        <h3>Vibe Coder Workflow</h3>
                        <p>Guided 3-stage workflow for AI planning and coding</p>
                    </div>
                    <div class="mode-card" id="classic-mode">
                        <span class="icon">üìÑ</span>
                        <h3>Classic Repo2File</h3>
                        <p>Traditional repo consolidation for any use case</p>
                    </div>
                </div>
            </section>

            <!-- Vibe Coder Workflow -->
            <section id="vibe-workflow" class="workflow-section">
                <div class="wizard-steps">
                    <div class="step active" data-step="1">
                        <span class="step-number">1</span>
                        <span class="step-label">Setup</span>
                    </div>
                    <div class="step" data-step="2">
                        <span class="step-number">2</span>
                        <span class="step-label">Stage</span>
                    </div>
                    <div class="step" data-step="3">
                        <span class="step-number">3</span>
                        <span class="step-label">Input</span>
                    </div>
                    <div class="step" data-step="4">
                        <span class="step-number">4</span>
                        <span class="step-label">Generate</span>
                    </div>
                </div>

                <!-- Step 1: Setup -->
                <div class="wizard-content" data-step="1">
                    <h3>Repository Setup</h3>
                    
                    <!-- Docker Integration -->
                    <div class="docker-section">
                        <label class="checkbox-label">
                            <input type="checkbox" id="useDocker">
                            <span>Use Docker Compose (for local dev logs)</span>
                        </label>
                        <div id="dockerConfig" class="docker-config hidden">
                            <input type="file" id="composeFile" accept=".yml,.yaml">
                            <label for="composeFile">Select docker-compose.yml</label>
                            <div id="dockerServices" class="service-list"></div>
                        </div>
                    </div>

                    <!-- Repository Selection -->
                    <div class="repo-selection">
                        <nav class="tabs">
                            <button class="tab-btn active" data-tab="repo-upload">Upload Repo</button>
                            <button class="tab-btn" data-tab="repo-github">GitHub URL</button>
                            <button class="tab-btn" data-tab="repo-local">Local Path</button>
                        </nav>

                        <div class="tab-content" id="repo-upload">
                            <div class="drop-area" id="dropArea">
                                <div class="drop-message">
                                    <span class="material-symbols-outlined">cloud_upload</span>
                                    <p>Drag & drop repository ZIP or folder</p>
                                    <label for="fileInput" class="file-input-label">Choose Files</label>
                                    <input type="file" id="fileInput" accept=".zip" hidden>
                                </div>
                            </div>
                        </div>

                        <div class="tab-content hidden" id="repo-github">
                            <input type="url" id="githubUrl" placeholder="https://github.com/username/repo">
                            <input type="text" id="githubBranch" placeholder="Branch (optional)">
                        </div>

                        <div class="tab-content hidden" id="repo-local">
                            <input type="text" id="localPath" placeholder="/path/to/your/repository">
                            <button class="browse-btn">Browse</button>
                        </div>
                    </div>

                    <!-- Vibe Statement -->
                    <div class="vibe-input">
                        <label for="vibeStatement">What's your vibe/goal?</label>
                        <textarea id="vibeStatement" placeholder="e.g., Add dark mode toggle to settings page"></textarea>
                        <span class="char-count">0 characters</span>
                    </div>

                    <button class="next-btn">Next ‚Üí</button>
                </div>

                <!-- Step 2: Stage Selection -->
                <div class="wizard-content hidden" data-step="2">
                    <h3>Select Your Stage</h3>
                    <div class="stage-cards">
                        <div class="stage-card" data-stage="A">
                            <span class="stage-icon">üí°</span>
                            <h4>Plan</h4>
                            <p>Fresh start - Need context for AI Planner</p>
                        </div>
                        <div class="stage-card" data-stage="B">
                            <span class="stage-icon">üíª</span>
                            <h4>Code</h4>
                            <p>Have a plan from AI Planner</p>
                        </div>
                        <div class="stage-card" data-stage="C">
                            <span class="stage-icon">üîÑ</span>
                            <h4>Iterate</h4>
                            <p>Have results from AI Coder</p>
                        </div>
                    </div>
                    <button class="prev-btn">‚Üê Back</button>
                    <button class="next-btn">Next ‚Üí</button>
                </div>

                <!-- Step 3: Stage-specific Input -->
                <div class="wizard-content hidden" data-step="3">
                    <h3>Additional Input</h3>
                    
                    <!-- Stage B Input -->
                    <div id="stage-b-input" class="stage-input hidden">
                        <label>AI Planner Output</label>
                        <div class="input-choice">
                            <button class="choice-btn active" data-choice="paste">Paste Text</button>
                            <button class="choice-btn" data-choice="file">Upload File</button>
                        </div>
                        <textarea id="plannerText" placeholder="Paste your AI Planner output here"></textarea>
                        <input type="file" id="plannerFile" class="hidden">
                    </div>

                    <!-- Stage C Input -->
                    <div id="stage-c-input" class="stage-input hidden">
                        <div class="file-input-group">
                            <label>Previous Output</label>
                            <input type="file" id="previousOutput">
                        </div>
                        <div class="file-input-group">
                            <label>Feedback Log</label>
                            <input type="file" id="feedbackLog">
                        </div>
                    </div>

                    <button class="prev-btn">‚Üê Back</button>
                    <button class="next-btn">Next ‚Üí</button>
                </div>

                <!-- Step 4: Generate -->
                <div class="wizard-content hidden" data-step="4">
                    <h3>Review & Generate</h3>
                    <div class="review-summary">
                        <div class="summary-item">
                            <span class="label">Repository:</span>
                            <span id="repoSummary">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">Vibe:</span>
                            <span id="vibeSummary">-</span>
                        </div>
                        <div class="summary-item">
                            <span class="label">Stage:</span>
                            <span id="stageSummary">-</span>
                        </div>
                        <div class="summary-item" id="dockerSummary" class="hidden">
                            <span class="label">Docker:</span>
                            <span id="dockerServices">-</span>
                        </div>
                    </div>
                    <button class="prev-btn">‚Üê Back</button>
                    <button class="generate-btn">Generate Context</button>
                </div>
            </section>

            <!-- Classic Mode (Hidden by default) -->
            <section id="classic-workflow" class="workflow-section hidden">
                <!-- Original repo2file UI content here -->
            </section>

            <!-- Progress Overlay -->
            <div id="progressOverlay" class="progress-overlay hidden">
                <div class="progress-content">
                    <div class="spinner"></div>
                    <h3>Processing Repository</h3>
                    <p id="progressMessage">Scanning files...</p>
                    <div class="progress-bar">
                        <div class="progress-fill"></div>
                    </div>
                    <p id="progressStats">0 files scanned</p>
                </div>
            </div>

            <!-- Results Section -->
            <section id="results" class="results-section hidden">
                <h2>Results</h2>
                <nav class="result-tabs">
                    <button class="tab-btn active" data-tab="copy">Copy Section</button>
                    <button class="tab-btn" data-tab="manifest">File Explorer</button>
                    <button class="tab-btn" data-tab="logs">Container Logs</button>
                    <button class="tab-btn" data-tab="stats">Statistics</button>
                </nav>

                <div class="result-content" id="copy">
                    <div class="copy-header">
                        <h3>Content for AI</h3>
                        <button class="copy-btn">Copy All</button>
                    </div>
                    <pre id="copyContent"></pre>
                </div>

                <div class="result-content hidden" id="manifest">
                    <div class="file-explorer">
                        <div class="file-tree"></div>
                        <div class="file-preview"></div>
                    </div>
                </div>

                <div class="result-content hidden" id="logs">
                    <div class="log-controls">
                        <select id="serviceSelector">
                            <option>Select Service</option>
                        </select>
                        <button class="refresh-logs">Refresh</button>
                    </div>
                    <div class="log-viewer">
                        <pre id="logContent"></pre>
                    </div>
                </div>

                <div class="result-content hidden" id="stats">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h4>Files Processed</h4>
                            <p id="filesCount">0</p>
                        </div>
                        <div class="stat-card">
                            <h4>Tokens Used</h4>
                            <p id="tokensUsed">0</p>
                        </div>
                        <div class="stat-card">
                            <h4>Files Skipped</h4>
                            <p id="filesSkipped">0</p>
                        </div>
                    </div>
                    <div class="skip-report">
                        <h4>Skipped Files</h4>
                        <ul id="skipList"></ul>
                    </div>
                </div>

                <button class="new-analysis">Start New Analysis</button>
            </section>
        </main>

        <footer>
            <p>&copy; 2025 BetterRepo2File. Vibe Coder Edition.</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/unified.js') }}"></script>
</body>
</html>