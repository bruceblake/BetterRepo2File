<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Convert a repository or files to a single text file optimized for LLM prompts">
    <meta name="keywords" content="repo2file, repository converter, LLM, AI, code consolidation">
    <title>Repo2File - Convert Repository to Single File</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=JetBrains+Mono&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header role="banner">
            <h1>Repo2File</h1>
            <p>Convert a repository or files to a single text file for LLM prompts</p>
        </header>

        <main class="input-section" role="main">
            <nav class="tabs" role="tablist" aria-label="Input method selection">
                <button class="tab-btn active" role="tab" aria-selected="true" aria-controls="file-upload" data-tab="file-upload">File Upload</button>
                <button class="tab-btn" role="tab" aria-selected="false" aria-controls="github-url" data-tab="github-url">GitHub URL</button>
            </nav>

            <div class="tab-content" id="file-upload" role="tabpanel" aria-labelledby="file-upload-tab">
                <div class="drop-area" id="dropArea" role="region" aria-label="File drop zone">
                    <div class="drop-message">
                        <p>Drag & drop files or folders here</p>
                        <p>or</p>
                        <label for="fileInput" class="file-input-label">Choose Files</label>
                        <input type="file" id="fileInput" multiple webkitdirectory directory hidden aria-describedby="file-input-help">
                        <span id="file-input-help" class="sr-only">Select multiple files or folders from your computer</span>
                    </div>
                    <div class="file-list" id="fileList" role="list" aria-label="Selected files"></div>
                </div>
            </div>

            <div class="tab-content hidden" id="github-url" role="tabpanel" aria-labelledby="github-url-tab">
                <div class="github-input">
                    <label for="githubUrlInput" class="sr-only">GitHub repository URL</label>
                    <input type="url" id="githubUrlInput" placeholder="Enter GitHub repository URL (e.g., https://github.com/username/repo)" aria-describedby="github-url-help">
                    <span id="github-url-help" class="sr-only">Enter the full URL of a GitHub repository</span>
                </div>
                <div class="branch-input">
                    <label for="branchInput">Branch (optional):</label>
                    <input type="text" id="branchInput" placeholder="main" title="Leave empty to use the default branch" aria-describedby="branch-help">
                    <span id="branch-help" class="sr-only">Specify a branch name or leave empty for the default branch</span>
                </div>
            </div>

            <div class="additional-options">
                <div class="profile-select">
                    <label for="profileSelect">Processing Profile:</label>
                    <select id="profileSelect">
                        <option value="">Custom Configuration</option>
                        <option value="frontend">Frontend Development</option>
                        <option value="backend">Backend Development</option>
                        <option value="datascience">Data Science</option>
                        <option value="documentation">Documentation</option>
                        <option value="mobile">Mobile Development</option>
                        <option value="microservices">Microservices</option>
                        <option value="gemini">Gemini 1.5 Pro (Large Context)</option>
                    </select>
                </div>
                <div class="file-types">
                    <label for="fileTypes">File types to include (space-separated, e.g., .py .js .tsx):</label>
                    <input type="text" id="fileTypes" placeholder="Leave empty to include all files">
                </div>
                <div class="exclusion-options">
                    <label class="checkbox-container">
                        <input type="checkbox" id="useGitignore" checked>
                        <span class="checkbox-text">Use .gitignore file if available (reduces output size)</span>
                    </label>
                </div>
                <div class="smart-mode-options">
                    <label class="checkbox-container">
                        <input type="checkbox" id="smartMode" checked>
                        <span class="checkbox-text">Use Smart Mode (AI-optimized output: auto-filter, truncate, detect binary files)</span>
                    </label>
                </div>
                <div class="token-mode-options">
                    <label class="checkbox-container">
                        <input type="checkbox" id="tokenMode">
                        <span class="checkbox-text">Use Token-Aware Mode (Ultra-optimized: 500K token budget, pathspec gitignore, priority-based)</span>
                    </label>
                </div>
                <div class="ultra-mode-options">
                    <label class="checkbox-container">
                        <input type="checkbox" id="ultraMode">
                        <span class="checkbox-text">Use Ultra Mode (Most advanced: exact token counting, semantic analysis, caching)</span>
                    </label>
                    <div class="ultra-settings hidden" id="ultraSettings">
                        <div class="vibe-input">
                            <label for="vibeStatement">My Vibe / Primary Goal / Problem I'm Solving:</label>
                            <textarea id="vibeStatement" placeholder="Describe your high-level goal or the vibe you want to achieve (e.g., 'Improve checkout speed', 'Refactor authentication for better security', 'Add real-time notifications')" rows="3"></textarea>
                            <small>This will be used to create a high-level context for your planning AI (e.g., Gemini 1.5 Pro).</small>
                        </div>
                        <div class="query-input">
                            <label for="intendedQuery">Intended LLM Query/Task (Optional):</label>
                            <textarea id="intendedQuery" placeholder="Describe what you plan to ask the LLM (e.g., 'Refactor authentication module', 'Add unit tests for payment service')" rows="3"></textarea>
                            <small>This helps prioritize the most relevant files and code sections for your specific task.</small>
                        </div>
                        <div class="planner-output-input">
                            <label for="plannerOutput">AI Planner Output (Optional):</label>
                            <textarea id="plannerOutput" placeholder="Paste the output from your planning AI (e.g., Gemini's plan) here. This will be integrated into the context for your coding AI." rows="5"></textarea>
                            <small>After getting a plan from Gemini, paste it here to create a super-context for Claude Code.</small>
                        </div>
                        <div class="model-select">
                            <label for="llmModel">LLM Model:</label>
                            <select id="llmModel">
                                <option value="gpt-4" selected>GPT-4</option>
                                <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                <option value="claude-3">Claude 3</option>
                                <option value="llama">Llama</option>
                                <option value="gemini-1.5-pro">Gemini 1.5 Pro</option>
                            </select>
                        </div>
                        <div class="budget-input">
                            <label for="tokenBudget">Token Budget:</label>
                            <input type="number" id="tokenBudget" value="500000" min="1000" max="2000000">
                        </div>
                    </div>
                </div>
            </div>

            <div class="process-btn-container">
                <button id="processBtn" class="process-btn" aria-label="Generate output file">Generate</button>
                <button id="previewBtn" class="preview-btn" aria-label="Preview first 10 files">Preview (First 10 Files)</button>
            </div>
        </main>

        <div class="loading-indicator hidden" id="loadingIndicator" role="status" aria-live="polite" aria-busy="true">
            <div class="spinner" aria-hidden="true"></div>
            <p>Processing... This may take a moment.</p>
        </div>

        <section class="output-section hidden" id="outputSection" aria-labelledby="output-heading">
            <div class="output-header">
                <h2 id="output-heading">Output</h2>
                <div class="exclusion-info" id="exclusionInfo" role="status" aria-live="polite">
                </div>
                <div class="output-actions">
                    <button id="copyBtn" class="action-btn" aria-label="Copy output to clipboard">Copy to Clipboard</button>
                    <button id="downloadBtn" class="action-btn" aria-label="Download output as file">Download</button>
                </div>
            </div>
            <div class="output-content">
                <pre id="outputContent" role="textbox" aria-readonly="true" aria-label="Generated output content" tabindex="0"></pre>
            </div>
        </section>

        <div class="error-message hidden" id="errorMessage" role="alert" aria-live="assertive">
            <p id="errorText"></p>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>